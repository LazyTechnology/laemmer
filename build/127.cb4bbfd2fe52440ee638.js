"use strict";(self.webpackChunkpayload_nextjs_server=self.webpackChunkpayload_nextjs_server||[]).push([[127],{89127:(e,a,l)=>{l.r(a),l.d(a,{default:()=>F});var t=l(67294),i=l(5977),s=l(9980),n=l(28630),d=l(75091),o=l(47489),r=l(40684),c=l(2143),m=l(49546),v=l(28584),u=l(93313),p=l(4983),b=l(46268),E=l(61439),f=l(19410),g=l(10448),_=l(72570),Z=l(50854),h=l(8742),N=l(28019),S=l(40829),w=l(45074),$=l(8792),y=l(11750),L=l(24531),k=l(17095),P=(l(88446),l(9684));const U="global-edit",R=e=>{var a,l,i,n,d,o,r,c,R,A,C,F,x,D,T,j;const{admin:{dateFormat:I}}=(0,s.Z)(),{publishedDoc:M}=(0,w.x5)(),{global:O,data:V,onSave:H,permissions:q,action:z,apiURL:B,initialState:G,isLoading:J}=e,{fields:K,preview:Q,versions:W,label:X,admin:{description:Y,hideAPIURL:ee}={}}=O,ae=null===(a=null==q?void 0:q.update)||void 0===a?void 0:a.permission;return t.createElement("div",{className:U},J&&t.createElement(S.Z,null),!J&&t.createElement(P.R.Provider,{value:"update"},t.createElement(u.Z,{className:"global-edit__form",method:"post",action:z,onSuccess:H,disabled:!ae,initialState:G},t.createElement("div",{className:"global-edit__main"},t.createElement(g.Z,{title:X,description:X,keywords:`${X}, Payload, CMS`}),t.createElement(v.Z,null),!((null===(l=O.versions)||void 0===l?void 0:l.drafts)&&(null===(n=null===(i=O.versions)||void 0===i?void 0:i.drafts)||void 0===n?void 0:n.autosave))&&t.createElement(Z.Z,null),t.createElement("div",{className:"global-edit__edit"},t.createElement("header",{className:"global-edit__header"},t.createElement("h1",null,"Edit"," ",X),Y&&t.createElement("div",{className:"global-edit__sub-header"},t.createElement(N.Z,{description:Y}))),t.createElement(E.Z,{readOnly:!ae,permissions:q.fields,filter:e=>!e.admin.position||e.admin.position&&"sidebar"!==e.admin.position,fieldTypes:_.Z,fieldSchema:K}))),t.createElement("div",{className:"global-edit__sidebar-wrap"},t.createElement("div",{className:"global-edit__sidebar"},t.createElement("div",{className:"global-edit__sidebar-sticky-wrap"},t.createElement("div",{className:"global-edit__document-actions"+((null===(d=O.versions)||void 0===d?void 0:d.drafts)&&!(null===(r=null===(o=O.versions)||void 0===o?void 0:o.drafts)||void 0===r?void 0:r.autosave)||Q?" global-edit__document-actions--has-2":"")},Q&&(!(null===(c=O.versions)||void 0===c?void 0:c.drafts)||(null===(A=null===(R=O.versions)||void 0===R?void 0:R.drafts)||void 0===A?void 0:A.autosave))&&t.createElement(p.Z,{generatePreviewURL:Q,data:V}),ae&&t.createElement(t.Fragment,null,(null===(C=O.versions)||void 0===C?void 0:C.drafts)&&t.createElement(t.Fragment,null,!O.versions.drafts.autosave&&t.createElement($.Z,null),t.createElement(y.Z,null)),!(null===(F=O.versions)||void 0===F?void 0:F.drafts)&&t.createElement(b.Z,null,"Save"))),t.createElement("div",{className:"global-edit__sidebar-fields"},Q&&(null===(x=O.versions)||void 0===x?void 0:x.drafts)&&!(null===(T=null===(D=O.versions)||void 0===D?void 0:D.drafts)||void 0===T?void 0:T.autosave)&&t.createElement(p.Z,{generatePreviewURL:Q,data:V}),(null===(j=O.versions)||void 0===j?void 0:j.drafts)&&t.createElement(t.Fragment,null,t.createElement(L.Z,null),O.versions.drafts.autosave&&ae&&t.createElement(k.Z,{publishedDocUpdatedAt:(null==M?void 0:M.updatedAt)||(null==V?void 0:V.createdAt),global:O})),t.createElement(E.Z,{readOnly:!ae,permissions:q.fields,filter:e=>"sidebar"===e.admin.position,fieldTypes:_.Z,fieldSchema:K})),t.createElement("ul",{className:"global-edit__meta"},W&&t.createElement("li",null,t.createElement("div",{className:"global-edit__label"},"Versions"),t.createElement(h.Z,{global:O})),V&&!ee&&t.createElement("li",{className:"global-edit__api-url"},t.createElement("span",{className:"global-edit__label"},"API URL"," ",t.createElement(f.Z,{value:B})),t.createElement("a",{href:B,target:"_blank",rel:"noopener noreferrer"},B)),V.updatedAt&&t.createElement("li",null,t.createElement("div",{className:"global-edit__label"},"Last Modified"),t.createElement("div",null,(0,m.default)(new Date(V.updatedAt),I))))))))))};var A=l(19826),C=l(60161);const F=e=>{var a,l;const{state:m}=(0,i.TH)(),v=(0,r.bU)(),{setStepNav:u}=(0,d.FP)(),{permissions:p,user:b}=(0,n.a)(),[E,f]=(0,t.useState)({}),{getVersions:g}=(0,w.x5)(),{serverURL:_,routes:{api:Z}}=(0,s.Z)(),{global:h}=e,{slug:N,label:S,fields:$,admin:{components:{views:{Edit:y}={}}={}}={}}=h,L=(0,t.useCallback)((async e=>{g();const a=await(0,A.Z)({fieldSchema:$,data:e.result,operation:"update",user:b,locale:v});f(a)}),[g,$,b,v]),[{data:k,isLoading:P}]=(0,o.Z)(`${_}${Z}/globals/${N}`,{initialParams:{"fallback-locale":"null",depth:0,draft:"true"}}),U=(null==m?void 0:m.data)||k;(0,t.useEffect)((()=>{u([{label:S}])}),[u,S]),(0,t.useEffect)((()=>{(async()=>{const e=await(0,A.Z)({fieldSchema:$,data:U,user:b,operation:"update",locale:v});f(e)})()}),[U,$,b,v]);const F=null===(a=null==p?void 0:p.globals)||void 0===a?void 0:a[N];return t.createElement(C.S,{allow:!0},t.createElement(c.Z,{DefaultComponent:R,CustomComponent:y,componentProps:{isLoading:P,data:U,permissions:F,initialState:E,global:h,onSave:L,apiURL:`${_}${Z}/globals/${N}${(null===(l=h.versions)||void 0===l?void 0:l.drafts)?"?draft=true":""}`,action:`${_}${Z}/globals/${N}?locale=${v}&depth=0&fallback-locale=null`}}))}}}]);